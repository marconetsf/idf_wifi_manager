<!DOCTYPE HTML>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>iPonia</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="./custom_style.css" />
    </head>
    <body onload="get_button_list()">
        <main class="container">
            <div class="iponiaLogo"></div>
          <section id="buttons">
            <div class="headings">
              <h2>iPonia</h2>
              <h3>Menu</h3>
            </div>
            <div class="grid" id = "button_list">
              <a href="./wifi.html"><button>Wi-fi</button></a>
            </div>
          </section>
        </main>
        <script>
            function get_button_list()
                {
                    try {
                        const xhttp = new XMLHttpRequest();
                        xhttp.open("GET", "./get_pages");
                        xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                        
                        xhttp.send(JSON.stringify({
                        "username": "dawdwa",
                        "password": "dawdwa"
                        }));

                        xhttp.onreadystatechange = function() 
                        {
                            if (this.readyState != 4) return;
                            const objects = JSON.parse(this.responseText);

                            if(objects['pages'].length > 0){
                                objects['pages'].forEach(updateButtonList);
                            }else{
                                document.querySelector("#button_list").innerHTML = '<a href="./wifi.html"><button>Wi-fi</button></a>';
                            }
                        }
                    } catch (error) {
                        document.querySelector("#button_list").innerHTML = '<a href="./wifi.html"><button>Wi-fi</button></a>';
                    }
                    
                    
                }

                function updateButtonList(item, index, arr)
                {
                    document.querySelector("#button_list").innerHTML = document.querySelector("#button_list").innerHTML +'<div><a href="'+item['url']+'"><button>'+item['name']+'</button></a></div>';
                }
        </script>
      </body>
    </html>