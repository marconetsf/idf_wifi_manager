<!DOCTYPE HTML>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>iPonia</title>
    <link rel="stylesheet" href="/style.css" />
    <link rel="stylesheet" href="/custom_style.css" />
    </head>
        <body>
            <main class="container">
                <div class="container">
                    <article>
                    <div class="iponiaLogo"></div>
                    <h1>Login</h1>
                    <form>
                        <input type="text" placeholder="UsuÃ¡rio" name= "username" id="username" value = "">
                        <input type="password" placeholder="Senha" name="password" id="password" value = "">
                        <input type="submit" onclick="login(); return false;" class="btn">
                    </form>
                    </article>
                </div>
            </main>
            

            <script>
                function login() 
                {
                    const username = document.getElementById("username").value;
                    const password = document.getElementById("password").value;

                    const xhttp = new XMLHttpRequest();
                    xhttp.open("POST", "/credentials");
                    xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");

                    xhttp.send(JSON.stringify({
                        "username": username,
                        "password": password
                    }));

                    xhttp.onreadystatechange = function () 
                    {
                        if (this.readyState == 4) 
                        {
                            const objects = JSON.parse(this.responseText);
                            console.log(objects.loginStatus);
                            
                            if (objects.loginStatus == "SUCCESS")
                            {
                                location.href = "/home.html";
                            }
                            else
                            {
                                alert('Credenciais invalidas');
                            }
                        }
                    };

                    return false;
                }
            </script>

        </body>
    </html>